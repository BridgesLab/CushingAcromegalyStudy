---
title: "Combined Analysis of HFD/NCD Dexamethasone Liver Triglycerides"
author: "Innocence Harvey and Dave Bridges"
date: "October 21, 2015"
output:
  html_document:
    keep_md: true
    fig_caption: true
---

```{r global_options, include=FALSE}
library(knitr)
opts_chunk$set(fig.path='figures/',
               echo=FALSE, warning=FALSE, message=FALSE,dev=c('png','pdf'))
options(scipen = 2, digits = 6)


knitr::knit_hooks$set(inline = function(x) {
  knitr:::format_sci(x, 'md')
})


superpose.eb <- function (x, y, ebl, ebu = ebl, length = 0.08, ...)
  arrows(x, y + ebu, x, y - ebl, angle = 90, code = 3,
  length = length, ...)

  
se <- function(x) sd(x, na.rm=T)/sqrt(length(x))

color.scheme <- c('black','red')
```


```{r data-entry}
filename <- '../../data/raw/Liver TG hfd and chow dex.csv'
combined_data <- read.csv(filename)
combined_data$Diet <- relevel(as.factor(combined_data$Diet), ref='Normal Chow Diet')
combined_data$Treatment <- relevel(as.factor(combined_data$Treatment), ref='Water')

library(dplyr)
library(tidyr)
se <- function(x) sd(x, na.rm=T)/sqrt(length(x))
tg.summary <-
  combined_data %>%
  group_by(Diet, Treatment) %>%
  summarize(Liver.TG.mean = mean(Liver.TG, na.rm=T),
            Liver.TG.se = se(Liver.TG),
            Liver.TG.sd = sd(Liver.TG),
            Liver.TG.n = length(Liver.TG))

kable(tg.summary, caption="Summary Statistics for Liver Triglycerides")
```

This script uses the files in `r filename`. These data are located in `r getwd()` and this script was most recently run on `r date()`.

```{r liver-tg-barplot}
plot.data <- select(tg.summary, Diet,Treatment, Liver.TG.mean) %>% spread(Diet, Liver.TG.mean)
plot.data.se <- select(tg.summary, Diet,Treatment, Liver.TG.se) %>% spread(Diet, Liver.TG.se)

plot <- barplot(as.matrix(plot.data[2:3]), beside=T, 
        ylab="Liver Triglycerides (ug/mg tissue)",col=color.scheme[1:2],
        las=1, ylim=c(0,max(tg.summary$Liver.TG.mean + tg.summary$Liver.TG.se)))

superpose.eb(plot, as.matrix(plot.data[2:3]), as.matrix(plot.data.se[2:3]))
legend("topleft", levels(combined_data$Treatment), fill=color.scheme, bty="n")
```

We observed a `r (filter(tg.summary, Diet=="High Fat Diet"&Treatment=="Water")$Liver.TG.mean-filter(tg.summary, Diet=="Normal Chow Diet"&Treatment=="Water")$Liver.TG.mean)/filter(tg.summary, Diet=="Normal Chow Diet"&Treatment=="Water")$Liver.TG.mean` fold increase with High Fat Diet and a `r (filter(tg.summary, Diet=="Normal Chow Diet"&Treatment=="Water")$Liver.TG.mean-filter(tg.summary, Diet=="Normal Chow Diet"&Treatment=="Dexamethasone")$Liver.TG.mean)/filter(tg.summary, Diet=="Normal Chow Diet"&Treatment=="Water")$Liver.TG.mean*100`% decrease with dexamethasone in chow but a `r (filter(tg.summary, Diet=="High Fat Diet"&Treatment=="Dexamethasone")$Liver.TG.mean-filter(tg.summary, Diet=="Normal Chow Diet"&Treatment=="Water")$Liver.TG.mean)/filter(tg.summary, Diet=="Normal Chow Diet"&Treatment=="Water")$Liver.TG.mean` fold increase with High Fat Diet and Dexamethasone.


# Statistics

```{r statistics}
tg.aov <- aov(Liver.TG ~ Diet + Treatment + Diet:Treatment, data=combined_data)
tg.tukey <- TukeyHSD(tg.aov)
```

From a two-way ANOVA with an interaction, the interaction term was significant (p=`r summary(tg.aov)[[1]]$"Pr(>F)"[3]`):

```{r aov-table-Lipe}
kable(summary(tg.aov)[[1]], caption="ANOVA for Liver Triglyceride Levels")
```

# Session Information

```{r session-info}
sessionInfo()
```