Detailed Analysis of Cushing and Acromegaly Results
======================================================

Started with analysed DESeq files.  For this analysis, I am using the filtered deseq analysis, which removed the lower 40% expressing transcripts.  This file was most recently processed on ```r date()```.

```{r file-input, echo=FALSE}
cushing_filename <- "../data/processed/cushing_deseq_results_filtered.csv"
acromegaly_filename <- "../data/processed/acromegaly_deseq_results_filtered.csv"
cushing_results <- read.csv(cushing_filename)
acromegaly_results <- read.csv(acromegaly_filename)
```

The data is using the input files **`r cushing_filename`** and **`r acromegaly_filename`**.

```{r annotation, echo=FALSE, message=FALSE}
#required packages
library(knitcitations, quietly=TRUE) #for generation of citations
library(biomaRt,quietly=TRUE)
write.bibtex(c('base',names(sessionInfo()$otherPkgs)), file = "references.bib", append=T, create_key=F) #writes references to bibtex file
bib <- read.bibtex("references.bib") #loads the bib file
#download gene name annotation data for results sets.
ensembl <- useMart("ensembl",dataset = 'hsapiens_gene_ensembl')
transcriptInfo <- getBM(
    attributes=c('ensembl_transcript_id', 'ensembl_gene_id','external_gene_id'), 
    values = 'ensembl_transcript_id',
    mart=ensembl)
#merge results files with transcript info files.
annotated.cushing.results <- merge(cushing_results, transcriptInfo, by.x="id", by.y="ensembl_transcript_id")
annotated.acromegaly.results <- merge(acromegaly_results, transcriptInfo, by.x="id", by.y="ensembl_transcript_id")
#write annotated results files.
write.csv(annotated.cushing.results, "../data/processed/Annotated DESeq Results - Cushing.csv")
write.csv(annotated.acromegaly.results, "../data/processed/Annotated DESeq Results - Acromegaly.csv")
```

The data was annotated from Ensembl data, using the biomaRt package `r citep(bib[[c("biomaRt1","biomaRt2")]])`.

Differentially Expressed Genes
--------------------------------
```{r differentially-expressed, dev=c('png','pdf'), echo=FALSE, fig.show='asis'}
acromegaly.diff.transcripts <- subset(annotated.acromegaly.results, padj <= 0.05) 
with(acromegaly.diff.transcripts, plot(log2FoldChange, padj, pch=16, main="Differentially Expressed Transcripts in Acromegaly Patients"))
acromegaly.up.transcripts <- subset(acromegaly.diff.transcripts, foldChange > 1)
acromegaly.up.genes <- unique(acromegaly.up.transcripts$external_gene_id)
write(as.character(acromegaly.up.genes), file = "../data/processed/Acromegaly Upregulated Genes.txt")

acromegaly.down.transcripts <- subset(acromegaly.diff.transcripts, foldChange < 1)
acromegaly.down.genes <- unique(acromegaly.down.transcripts$external_gene_id)
write(as.character(acromegaly.down.genes), file = "../data/processed/Acromegaly Downregulated Genes.txt")

cushing.diff.transcripts <- subset(annotated.cushing.results , padj <= 0.05) 
with(cushing.diff.transcripts, plot(log2FoldChange, padj, pch=16, main="Differentially Expressed Transcripts in Cushing's Patients"))
cushing.up.transcripts <- subset(cushing.diff.transcripts, foldChange > 1)
cushing.up.genes <- unique(cushing.up.transcripts$external_gene_id)
write(as.character(cushing.up.genes), file = "../data/processed/Cushing Upregulated Genes.txt")

cushing.down.transcripts <- subset(cushing.diff.transcripts, foldChange < 1)
cushing.down.genes <- unique(cushing.down.transcripts$external_gene_id)
write(as.character(cushing.down.genes), file = "../data/processed/Cushing Downregulated Genes.txt")
```

### Acromegaly

There were **`r dim(acromegaly.diff.transcripts)[1]`** differentially expressed transcripts from the acromegaly patients, with **`r table(acromegaly.diff.transcripts$log2FoldChange > 0)[1]`** transcripts downregulated and **`r table(acromegaly.diff.transcripts$log2FoldChange > 0)[2]`** transcripts upregulated.

This corresponds to **`r length(acromegaly.up.genes)`** upregulated genes and **`r length(acromegaly.down.genes)`** downregulated genes.

### Cushing's Disease

There were **`r dim(cushing.diff.transcripts)[1]`** differentially expressed transcripts from the acromegaly patients, with **`r table(cushing.diff.transcripts$log2FoldChange > 0)[1]`** transcripts downregulated and **`r table(cushing.diff.transcripts$log2FoldChange > 0)[2]`** transcripts upregulated.

This corresponds to **`r length(cushing.up.genes)`** upregulated genes and **`r length(cushing.down.genes)`** downregulated genes.

Bibiography
------------
```{r bibliography, echo=FALSE, results='asis'}
bibliography("html") 
```

Session Information
-------------------

For the R session, the package versions were:
```{r}
sessionInfo()
```
